# 2章


## ナイーブツリー（素朴な木）


題材はニュースサイトのコメント欄。


コメントはスレッド形式で表示される。スレッドはディスカッションのトピックに応じて枝分かれする。


コメントのスレッドをすべて格納し、シンプルかつ効率的に特定のスレッド全体を取得する方法はないか？





### 2.1 目的：階層構造を格納し、クエリを実行する。


再帰的関連を持つデータはツリー上の構造で表現される。


親を持たない最上位のノードを**ルート**、子を持たない最下部のノードを**リーフ**、中間のノードを**非葉ノード**という。


ツリー構造で表されるものの代表例としては、


* 組織図


* スレッド形式のコメント欄
などがある。

### 2.2 アンチパターン：常に親のみに依存する



# 9章

## ラウンディングエラー（丸め誤差）

題材はコスト（金額）の集計。

FLOATのカラムを用いて計算を行ったところ、誤差が生じてしまった。

### 9.1 目的：整数の代わりに小数値を使用する
小数の計算を正しく行いたい。

### 9.2 アンチパターン：FLOATデータ型を使用する
SQLのFLOATデータ型は、ほかのプログラミング言語と同様にIEEE754標準に従って実数を2進数形式でエンコードしている。
FLOATを効果的に使用するためには、浮動小数点数の特徴を理解せねばならない。

#### 9.2.1 丸めが避けられない
10進数において、三分の一を小数として表現しようとすると、0.333333..のように循環小数となり、**無限精度**が必要となる。これへの回避策として、0.333のように可能な限りオリジナルに近い値（**有限精度**の値）を用いる。
これと同様に、2進数において、例えば59.95は表現するために無限精度が必要となる。FLOATを使う時点で丸め誤差を避けられない。

#### 9.2.2 SQLでのFLOATの使用
